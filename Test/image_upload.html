<head>
    <link rel="stylesheet" href="image_upload.css">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
</head>

<body>
    <div>
        <input type="file" id="real-input" class="image_inputType_file" accept="img/*" required multiple>
        <button class="browse-btn">사진업로드</botton>
    </div>

    <h3>이미지 미리보기</h3>
    <div id="imagePreview">
        <img id="img" />
    </div>

    <script>
        const browseBtn = document.querySelector('.browse-btn');
        const realInput = document.querySelector('#real-input');

        browseBtn.addEventListener('click',()=>{
            realInput.click();
        });

        function readInputFile(e){
            var sel_files = [];
            
            sel_files = [];
            $('#imagePreview').empty();
            
            var files = e.target.files;
            var fileArr = Array.prototype.slice.call(files);
            var index = 0;
            
            fileArr.forEach(function(f){
                if(!f.type.match("image/.*")){
                    alert("이미지 확장자만 업로드 가능합니다.");
                    return;
                };
                if(files.length < 11){
                    sel_files.push(f);
                    var reader = new FileReader();
                    reader.onload = function(e){
                        var html = `<a id=img_id_${index}><img src=${e.target.result} data-file=${f.name} /></a>`;
                        $('imagePreview').append(html);
                        index++;
                    };
                    reader.readAsDataURL(f);
                }
            })
            if(files.length > 11){
                alert("최대 10장까지 업로드 할 수 있습니다.");
            }
        }

        $('#real-input').on('change',readInputFile);
    </script>
</body>
